<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Login</title>
</head>
<body>

<h2>Login to Fake Account Detector</h2>
<button id="login">Login with Google</button>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
  firebase.initializeApp({
    apiKey: "AIzaSyDMQLzZD8978J-ENipP4wmZhywn9ZxHD7w",
    authDomain: "yt-fake-detector.firebaseapp.com",
    projectId: "yt-fake-detector"
  });

  const auth = firebase.auth();
  const EXTENSION_ID = "neenbpclgbocljpjenbfaggccdnhlkmo";

  document.getElementById("login").addEventListener("click", async () => {
    console.log("Login button clicked");

    try {
      const provider = new firebase.auth.GoogleAuthProvider();
      const result = await auth.signInWithPopup(provider);

      console.log("Firebase login success");

      const user = {
        uid: result.user.uid,
        email: result.user.email,
        name: result.user.displayName
      };

      chrome.runtime.sendMessage(
        neenbpclgbocljpjenbfaggccdnhlkmo,
        { type: "LOGIN_SUCCESS", user },
        () => window.close()
      );

    } catch (err) {
      console.error("Firebase login error:", err);
      alert(err.message);
    }
  });
</script>

</body>
</html>
